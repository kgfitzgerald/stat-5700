---
title: "Lab 06: Discrete Distributions in R"
format: pdf
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r, warning = FALSE, message = FALSE}
library(tidyverse)
```

# Overview

As you'll recall from Lab 04, R includes many built in functions for common distributions. Commands for each follow the same basic format. The abbreviated name of the distribution is preceded by once of four letters:

-   "d" for the density function (probability distribution for discrete random variables)
-   "p" for the cumulative distribution function (cdf)
-   "q" for the quantile function (gives the x value for a given cumulative probability)
-   "r" for random (generates a random number based on the distribution)

## Geometric distribution

**NOTE: In R, the geometric distribution is parameterized as the number of FAILURES until the 1st success.** Whereas, in the book and lecture notes we consider the random variable Y to be the trial on which the first success occurs. This means generally you will need to convert Y to the number of failures, X, as X = Y - 1 before using the built-in R functions.

For example, if you want to find $P(Y = 3)$ (1st success happens on 3rd trial), this is equivalent to $P(X = 2)$ (2 failures before 1st success). This is calculated below, assuming a probability of success of 0.75

```{r}
dgeom(2, 0.75)
```

We can confirm it by calculating in manually:

```{r}
#P(Y = 3) = p(3) = (1 - p)^(3 - 1)*(p)
(1 - .75)^2*.75
```

`pgeom(x, prob)` -- returns $F(x) = P(X \leq x),$ cumulative probabilities for the geometric distribution, again where X = number of failures before 1st success.

$P(Y \leq 3) = P(X \leq 2)$

```{r}
pgeom(2, .75)

#check manually
#P(Y <= 3) = p(1) + p(2) + p(3) = sum((1 - p)^(y - 1)*(p)) for y = 1,2,3
y <- c(1,2,3)
p <- 0.75
p_y <- (1 - p)^(y-1)*p
p_y
sum(p_y)
```

## Negative Binomial distribution

+ `dnbinom(x, size, prob)` calculates $P(Y = x + r)$ for a random variable $Y \sim negbinom(r = size, p = prob)$. 
    + Note the first argument is `x` is the number of failures (`y - r`). 
    + The `size` argument is what we are used to referring to as `r`, the desired number of successes
+ `pnbinom(q, size, prob)` calculates $P(Y \leq q)$, the cumulative probability up to the cutoff `q`

**Example 3.14 from textbook**

A geological study indicates that an exploratory oil well drilled in a particular region should strike oil with probability 0.2. Find the probability that the third oil strike comes on the fifth well drill.

```{r}
#P(Y = 5), where Y ~ nbinom(r = 3, p = 0.2)
#implies x = 2 failures
dnbinom(2, size = 3, prob = 0.2)
```

## Hypergeometric distribution

+ `dhyper(x, m, n, k)` calculates $P(X = x)$, where $X$ is a hypergeometric random variable and:

    + `x` = number of objects sampled that have the desired "success" feature ($y$ in our notation)
    + `m` = number of objects with the success feature in the population ($r$ in our notation)
    + `n` = number of objects WITHOUT the success feature in the population ($N - r$ in our notation)
    + `k` = sample size ($n$ in our notation)

**Example 3.16 from textbook**

From a group of 20 PhD engineers, 10 are randomly selected for employment. What is the probability that the 10 selected include all the 5 best engineers in the group of 20?

```{r}
#N = 20 population size
#r = 5 total in population w/ success feature
#y = 5 sampled w/ success feature (x in dhyper)
#n = 10 sample size (k in dhyper)
#N - r = 15 (n in dhyper)

dhyper(x = 5, m = 5, n = 15, k = 10)
```

## Poisson Distribution

+ `dpois(x, lambda)` calculates $P(X = x)$ for $X \sim Poisson(\lambda)$
+ `ppois(q, lambda)` calculates $P(X \leq q)$

**Example 3.19 in textbook**

Let $X \sim Poisson(\lambda = 1)$. Find $P(Y = 0)$, $P(Y = 1)$, $P(Y = 2)$, $P(Y \geq 1)$.

```{r}
dpois(0, lambda = 1) 
dpois(1, lambda = 1)
dpois(2, lambda = 1)
1 - dpois(0, lambda = 1)
```

# Tasks

For this lab, you will (re-)do odd problems from HW 05, but rather than solving by hand, you will use the `dgeom()`, `dnbinom()`, `dhyper()`, and `dpois()` to obtain the answer. 

## 3.67

```{r}

```

## 3.73

```{r}

```

## 3.93

```{r}

```

## 3.97a-b

```{r}

```

## 3.103

```{r}

```

## 3.105b

```{r}

```

## 3.121

```{r}

```
